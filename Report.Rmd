---
title: "**Kleefstra Syndrome Disease Concept Model**"
author:
  - Teaching Fellow - Minh Thu Bui
  - Supervisor - Professor Masanao Yajima
  - Wuge Li, Maysen Pagan, Amie Thomas
output: 
  bookdown::pdf_document2:
    toc: false
    number_sections: true
    
---

# Project Background and Objectives

# Visualizations

## Total Frequencies Bar Plot

### Analysis

## Age Group Frequencies Heatmap

### Analysis

## Age Group Frequencies Bar Plot

Another visualization that allows you to observe changes in the frequencies of references over different age groups is a stacked bar plot. Figure \@ref(fig:stacked-plot) shows stacked bar plots for the frequencies of referenced KS Defining Concepts, KS Individual Concepts, and KS Caregiver Impacts. The different colors in each plot represent different concepts or impacts and the labeled frequencies represent the most referenced concept or impact for that age group.

```{r, echo = FALSE}
suppressPackageStartupMessages(library(ggplot2))
suppressPackageStartupMessages(library(tidyverse))
suppressPackageStartupMessages(library(gridExtra))
#load data
lifespan <- read.csv("~/Desktop/Client Projects/Kristen Conners/KSProject/KS_lifespan.csv")
lifespan$X <- str_replace(lifespan$X, " impact", "")
lifespan$X <- str_replace(lifespan$X, "and", "&")
#data set for references to symptoms
symptoms <- lifespan[2:15,-6]
colnames(symptoms) <- c("symptom", "1", "2", "3", "4")
symptoms <- symptoms %>% pivot_longer(names_to = "age", values_to = "value", cols = 2:5)
#data set for references to individual impacts
ind_impacts <- lifespan[18:21,-6]
colnames(ind_impacts) <- c("impact", "1", "2", "3", "4")
ind_impacts <- ind_impacts %>% pivot_longer(names_to = "age", values_to = "value", cols = 2:5)
#data set for references to caregiver impacts
care_impacts <- lifespan[24:27,-6]
colnames(care_impacts) <- c("impact", "1", "2", "3", "4")
care_impacts <- care_impacts %>% pivot_longer(names_to = "age", values_to = "value", cols = 2:5)
```


```{r, echo = FALSE}
#frequencies
symptoms_freq <- symptoms %>% group_by(age) %>% 
  mutate(sum = sum(value), freq = value/sum)

#stacked barplots for KS Defining Concepts
plot1 <- ggplot(symptoms, aes(fill=symptom, y=value, x=age)) + 
  geom_bar(position="fill", stat="identity") +
  labs(x = "Age Group", y = "Proportion of References") + 
  theme_grey() +
  scale_fill_manual(name = "A. KS Defining Concepts",
                    values = c("#cc6666", "#cc8a90", "#ccb966", "#e59366", "#2d9f48", "#8acc66", "#94e1a6", "#66bbe5", "#6b98e6", "#4052c9", "#7e40c9", "#a766cc", "#c94072", "#d15c5c"))+
  scale_x_discrete(labels=c("<2","2-4","5-11", "12-17")) +
  theme(legend.title = element_text(face = "bold")) +
  annotate("text", x = 1, y = 0.43, label = 0.1786) +
  annotate("text", x = 2, y = 0.26, label = 0.2393) +
  annotate("text", x = 3, y = 0.65, label = 0.2034) +
  annotate("text", x = 4, y = 0.90, label = 0.1749)
```

```{r, echo = FALSE}
#frequencies
ind_freq <- ind_impacts %>% group_by(age) %>% 
  mutate(sum = sum(value), freq = value/sum)

#stacked barplots for KS individual impacts
plot2 <- ggplot(ind_impacts, aes(fill=impact, y=value, x=age)) + 
  geom_bar(position="fill", stat="identity") +
  labs(x = "Age Group", y = "Proportion of References") + 
  theme_grey() +
  scale_fill_manual(name = "B. KS Individual Impacts",
                    values = c("#cc6666", "#ccb966","#2d9f48", "#6b98e6"))+
  scale_x_discrete(labels=c("<2","2-4","5-11", "12-17")) +
  theme(legend.title = element_text(face = "bold")) +
  annotate("text", x = 1, y = 0.5, label = 0.9355) +
  annotate("text", x = 2, y = 0.5, label = 0.65) +
  annotate("text", x = 3, y = 0.5, label = 0.4957) +
  annotate("text", x = 4, y = 0.5, label = 0.3626)
```

```{r, echo = FALSE}
#frequencies
care_freq <- care_impacts %>% group_by(age) %>% 
  mutate(sum = sum(value), freq = value/sum)

#stacked barplots for KS caregiver impacts
plot3 <- ggplot(care_impacts, aes(fill=impact, y=value, x=age)) + 
  geom_bar(position="fill", stat="identity") +
  labs(x = "Age Group", y = "Proportion of References") + 
  theme_grey() +
  scale_fill_manual(name = "C. KS Caregiver Impacts",
                    values = c("#cc6666", "#ccb966","#2d9f48", "#6b98e6"))+
  scale_x_discrete(labels=c("<2","2-4","5-11", "12-17")) +
  theme(legend.title = element_text(face = "bold")) +
  annotate("text", x = 1, y = 0.75, label = 0.6667) +
  annotate("text", x = 2, y = 0.75, label = 0.5366) +
  annotate("text", x = 3, y = 0.75, label = 0.4875) +
  annotate("text", x = 4, y = 0.2, label = 0.4028)
```

```{r stacked-plot, fig.width=12, fig.height = 7, echo = FALSE, fig.cap = "Labeled frequencies represent the most frequent concept or impact for that age group."}
grid.arrange(plot1, arrangeGrob(plot2, plot3), ncol = 2)
```


### Analysis

These stacked bar plots are a great way to observe changes in the frequency of references across different age groups at a high level. For example, in stacked bar plot B, it is clear to see that health is the most referenced individual impact for children under the age of 2. However, as the age groups increase, the references to health decreases. This suggests that the significance of the child's health decreases as the child gets older when other impacts like social and daily living impacts begin to matter more. A similar pattern can be seen in bar plot C. As the age groups increase in age, the frequencies of references to emotional caregiver impacts decreases while social impacts increase.

There is a challenge with the interpretability of stacked bar plots. While the patterns mentioned above are clear to see looking at the plots, there is a difficulty in comparing concepts or impacts when they do not start at a common baseline. For example in bar plot A, it is hard to compare the references to gastrointestinal concepts between the age groups of less than 2 and 2 to 4 year olds. Additionally, due to the stacked nature of the bar plots, it is also difficult to determine what the exact frequency is of the referenced concept or impact unless it is the bottom bar.
